system:
  ip_address: 10.0.0.1
  application_file: "autolamella"
  application_file_rectangle: "autolamella"
  #application_file_rectangle: "Si_Alex"
  application_file_cleaning_cross_section: "autolamella"
  stage_rotation_flat_to_electron: 50 # degrees
  stage_rotation_flat_to_ion: 230 # degrees
  pretilt_angle: 27 # degrees
initial_position:
  sample_grid: # need to check the coordinate systems
    x: -3.2375e-3
    y: 3.9354e-3
    z: 31.379e-3
    coordinate_system: "Raw"
  landing_grid:
    # x is +6 mm from sample grid center
    x: 2.76265e-3
    # y is the same as sample grid center
    y: 3.9354e-3
    # z is the same as sample grid center
    z: 31.379e-3
    coordinate_system: "Raw"
imaging:
  horizontal_field_width: 150e-6 # ion beam horizontal field of view (meters)
  dwell_time: 1e-6
  resolution: "1536x1024"
  imaging_current: 20e-12 # 20pA, 20kV for Ar, 30pA, 30kV for Xe # 3kV eB
  save: False
  autocontrast: True
  max_eb_hfw: 2700e-6
  max_ib_hfw: 900e-6
gamma:
  correction: True
  min_gamma: 0.15
  max_gamma: 1.8
  scale_factor: 0.01
  threshold: 46 # px
reference_images:
  landing_post_ref_img_resolution: "1536x1024"
  landing_post_ref_img_dwell_time: 1e-6
  landing_post_ref_img_hfw_lowres: 400e-6
  landing_post_ref_img_hfw_highres: 150e-6
  trench_area_ref_img_resolution: "1536x1024"
  trench_area_ref_img_dwell_time: 1e-6
  trench_area_ref_img_hfw_lowres: 400e-6
  trench_area_ref_img_hfw_highres: 80e-6
  needle_ref_img_resolution: "1536x1024"
  needle_ref_img_dwell_time: 1e-6
  needle_ref_img_hfw_lowres: 150e-6
  needle_ref_img_hfw_highres: 100e-6
  needle_with_lamella_ref_img_resolution: "3072x2048"
  needle_with_lamella_ref_img_hfw_highres: 150e-6
  needle_with_lamella_ref_img_dwell_time_electron: 1e-6
  needle_with_lamella_ref_img_dwell_time_ion: 0.5e-6
  needle_with_lamella_shifted_img_lowres: 250e-6
  needle_with_lamella_shifted_img_highres: 150e-6
  landing_lamella_ref_img_hfw_lowres: 150e-6
  landing_lamella_ref_img_hfw_highres: 80e-6
  grid_ref_img_hfw_lowres: 2750e-6
  milling_ref_img_hfw_lowres: 150e-6
  milling_ref_img_hfw_highres: 50e-6
  liftout_ref_img_hfw_lowres: 180e-6
  liftout_ref_img_hfw_highres: 80e-6
  thinning_ref_img_hfw_lowres: 400e-6
  thinning_ref_img_hfw_medres: 150e-6
  thinning_ref_img_hfw_highres: 80e-6
  thinning_ref_img_hfw_superres: 30e-6
calibration:
  eucentric_hfw_lowres: 900e-6
  eucentric_hfw_midres: 400e-6
  eucentric_hfw_highres: 200e-6
  drift_correction_hfw_highres: 80e-6
  stage_height_limit: 3.7e-3 # relative coordinates
lamella:
  lamella_width: 12e-6 # in meters
  lamella_height: 8e-6 # in meters
  total_cut_height: 10e-6 # in meters
  milling_depth: 5e-6 # default milling depth, unless otherwise specified # zebra 2.2
  milling_current: 2.4e-9  # default milling current, unless otherwise specified # zebra 2.4e-9 0.74e-9
  hfw: 150e-6
  protocol_stages: # stages will be milled in the order they appear here
    # rough_cut
    - percentage_roi_height: 0.3 # fractional percentage of total_cut height
      percentage_from_lamella_surface: 0.7 # fractional percentage
      milling_current: 2.4e-9 # in meters
    # regular_cut
    - percentage_roi_height: 0.8 # fractional percentage of total_cut height
      percentage_from_lamella_surface: 0.0 # fractional percentage
      milling_current: 2.4e-9 # in Amps
      milling_depth: 5e-6 # in meters
new_lamella:
  lamella_width: 12e-6 # in meters
  lamella_height: 8e-6 # in meters
  total_cut_height: 10e-6 # in meters
  milling_depth: 5e-6 # default milling depth, unless otherwise specified # zebra 2.2
  milling_current: 2.4e-9  # default milling current, unless otherwise specified # zebra 2.4e-9 0.74e-9
  hfw: 150e-6
  size_ratio: 2.0 # the ratio between the upper trench and the lower trench (1 = symmetric, 2 = upper twice as large as lower )
  protocol_stages: # stages will be milled in the order they appear here
    # rough cut
    - milling_current: 2.4e-9
      offset: 2e-6
      trench_height: 2e-6
    # regular cut
    - milling_current: 2.4e-9
      offset: 0e-6
      trench_height: 5e-6
needle:
  horizontal_field_width: 150e-6 # ion beam horizontal field of view (meters)
  dwell_time: 1e-6
  resolution: "1536x1024"
machine_learning:
  eb_brightness: 0.4
  eb_contrast: 0.70
  ib_brightness: 0.41
  ib_contrast: 0.86
  weights: boost_n05_model.pt
jcut:
  jcut_milling_current: 0.74e-9 # in Amps
  jcut_angle: 6  # in degrees (relative)
  jcut_length: 12e-6 # in meters
  jcut_lamella_depth: 5e-6 # in meters
  jcut_trench_thickness: 1e-6 # in meters
  jcut_milling_depth: 5e-6 # in meters
  extra_bit: 8e-6  # J-cut should extend out a little past the lamella
  mill_lhs_jcut_pattern: true # true or false
  mill_rhs_jcut_pattern: true # true or false
  mill_top_jcut_pattern: true # true or false
weld:
  width: 3e-6
  height: 10e-6
  depth: 15e-9
  rotation: 0
sharpen:
  height: 2.5e-6
  width:  20e-6
  depth: 8e-6
  bias: 0.25e-6
  hfw: 150e-6
  tip_angle: 10
  needle_angle: 40
  sharpen_milling_current: 6.2e-9 # in Amps
cut:
  width: 8e-6
  height: 0.5e-6
  depth: 20e-6
  rotation: 0
  hfw: 100e-6
  gap: 2e-6
  hgap: 4e-6
flatten_landing:
  center_x: 0
  center_y: 0
  width: 2e-6
  height: 25e-6
  depth: 10e-6
thin_lamella: # Lamella parameters
  rotation_angle: 50 # deg (raw)
  tilt_angle: 0 # deg
  lamella_width:  3.5e-6 # In meters. Width of lamella.
  lamella_height: 0.45e-6 # In meters. Thickness of lamella.
  total_cut_height: 5e-6 # In meters. Combined milling region above & below.
  milling_depth: 0.1e-6 # In meters. Default milling depth.
  milling_current: 0.89e-9 # In Amperes. Default milling current.
  hfw: 30e-6
  # Protocol stages are milled in the order they appear here.
  # Stages may override the default parameters above Eg: current, depth, etc.
  protocol_stages:
#  # Rough cut, stage 1
  - percentage_roi_height: 0.5 # Milling size as fraction of total_cut_height.
    percentage_from_lamella_surface: 0.2 # Fraction from surface of lamella.
    milling_depth: 0.4e-6 # In meters. Overrides the default milling depth.
    milling_current: 0.2e-9 # In Amperes. Overrides the default current.
#  # Regular cut, stage 2
  - percentage_roi_height: 0.3 # Milling size as fraction of total_cut_height.
    percentage_from_lamella_surface: 0.1 # Fraction from surface of lamella.
    milling_depth: 0.4e-6 # In meters. Overrides the default milling depth.
    milling_current: 0.2e-9 # In Amperes. Overrides the default current.
  # Polishing cut, stage 3
  - percentage_roi_height: 0.1 # think this should be 1 if the only stage # Milling size as fraction of total_cut_height.
    percentage_from_lamella_surface: 0. # Fraction from surface of lamella.
    milling_depth: 0.4e-6 # In meters. Overrides the default milling depth.
    milling_current: 20e-12 # In Amperes. Overrides the default current.
#    lamella_width: 4e-6 # In meters. Width of lamella.
platinum:
  application_file: "cryo_Pt_dep"
  gas: "Pt cryo"
  position: "cryo"
  whole_grid:
    time: 20
    hfw: 30e-6
    length: 7e-6
  weld:
    time: 20
    hfw: 100e-6
    length: 15e-6
